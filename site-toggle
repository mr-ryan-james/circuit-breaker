#!/usr/bin/env bash
set -Eeuo pipefail

# Thin wrapper that preserves the passwordless sudo entrypoint at:
#   /Users/ryanpfister/Dev/site-blocker/site-toggle
#
# It executes the compiled TypeScript CLI. Root/sudo is only needed for commands
# that edit /etc/hosts (on/off/choose feed/daemon tick).

NODE_BIN="/opt/homebrew/bin/node"
CLI_JS="/Users/ryanpfister/Dev/site-blocker/packages/cli/dist/index.js"

if [[ ! -x "$NODE_BIN" ]]; then
  echo "Missing Node binary at $NODE_BIN"
  echo "Install Node via Homebrew, or update site-toggle wrapper to point at your node."
  exit 1
fi

if [[ ! -f "$CLI_JS" ]]; then
  echo "Missing compiled CLI at $CLI_JS"
  echo "Run: pnpm install && pnpm build"
  exit 1
fi

exec "$NODE_BIN" --no-warnings "$CLI_JS" "$@"
